<!-- æ·»åŠ èœå“é¡µé¢ -->
<view class="add-dish-container">
  <view class="form-section">
    <view class="form-group">
      <text class="form-label">èœå“åç§°</text>
      <input
        class="form-input"
        placeholder="è¯·è¾“å…¥èœå“åç§°"
        value="{{dish.name}}"
        bindinput="onNameInput"
      />
    </view>

    <view class="form-group">
      <text class="form-label">èœå“æè¿°</text>
      <textarea
        class="form-textarea"
        placeholder="è¯·è¾“å…¥èœå“æè¿°"
        value="{{dish.description}}"
        bindinput="onDescriptionInput"
        maxlength="200"
      />
    </view>

    <view class="form-row">
      <view class="form-group half-width">
        <text class="form-label">åˆ†ç±»</text>
        <picker
          class="form-picker"
          range="{{['ä¸»é£Ÿ', 'æ±¤ç±»', 'ç”œç‚¹', 'é¥®æ–™', 'å°åƒ']}}"
          range-key=""
          value="{{['main', 'soup', 'dessert', 'drink', 'snack'].indexOf(dish.category)}}"
          bindchange="onCategoryChange"
        >
          <view class="picker-text">
            {{dish.category === 'main' ? 'ä¸»é£Ÿ' : dish.category === 'soup' ? 'æ±¤ç±»' : dish.category === 'dessert' ? 'ç”œç‚¹' : dish.category === 'drink' ? 'é¥®æ–™' : 'å°åƒ'}}
          </view>
        </picker>
      </view>

      <view class="form-group half-width">
        <text class="form-label">éš¾åº¦</text>
        <picker
          class="form-picker"
          range="{{['ç®€å•', 'ä¸­ç­‰', 'å¤æ‚']}}"
          value="{{['easy', 'medium', 'hard'].indexOf(dish.difficulty)}}"
          bindchange="onDifficultyChange"
        >
          <view class="picker-text">
            {{dish.difficulty === 'easy' ? 'ç®€å•' : dish.difficulty === 'medium' ? 'ä¸­ç­‰' : 'å¤æ‚'}}
          </view>
        </picker>
      </view>
    </view>

    <view class="form-row">
      <view class="form-group half-width">
        <text class="form-label">çŠ¶æ€</text>
        <picker
          class="form-picker"
          range="{{['å¯åˆ¶ä½œ', 'å­¦ä¹ ä¸­', 'æš‚åœä¾›åº”']}}"
          value="{{['available', 'learning', 'paused'].indexOf(dish.status)}}"
          bindchange="onStatusChange"
        >
          <view class="picker-text">
            {{dish.status === 'available' ? 'å¯åˆ¶ä½œ' : dish.status === 'learning' ? 'å­¦ä¹ ä¸­' : 'æš‚åœä¾›åº”'}}
          </view>
        </picker>
      </view>

      <view class="form-group half-width">
        <text class="form-label">å‡†å¤‡æ—¶é—´(åˆ†é’Ÿ)</text>
        <input
          class="form-input"
          type="number"
          placeholder="30"
          value="{{dish.prepTime}}"
          bindinput="onPrepTimeInput"
        />
      </view>
    </view>
  </view>

  <!-- é£Ÿææ¸…å• -->
  <view class="section">
    <view class="section-header">
      <text class="section-title">é£Ÿææ¸…å•</text>
    </view>

    <view class="ingredients-list">
      <view class="ingredient-item" wx:for="{{dish.ingredients}}" wx:key="index">
        <view class="ingredient-info">
          <text class="ingredient-name">{{item.name}}</text>
          <text class="ingredient-amount">{{item.amount}}</text>
          <text class="ingredient-category">
            {{item.category === 'main' ? 'ä¸»æ–™' : item.category === 'side' ? 'è¾…æ–™' : 'è°ƒæ–™'}}
          </text>
        </view>
        <text class="remove-btn" bindtap="removeIngredient" data-index="{{index}}">åˆ é™¤</text>
      </view>
    </view>

    <view class="add-ingredient-form">
      <view class="form-row">
        <input
          class="form-input small"
          placeholder="é£Ÿæåç§°"
          value="{{newIngredient.name}}"
          bindinput="onIngredientNameInput"
        />
        <input
          class="form-input small"
          placeholder="ç”¨é‡"
          value="{{newIngredient.amount}}"
          bindinput="onIngredientAmountInput"
        />
        <picker
          class="form-picker small"
          range="{{['ä¸»æ–™', 'è¾…æ–™', 'è°ƒæ–™']}}"
          value="{{['main', 'side', 'seasoning'].indexOf(newIngredient.category)}}"
          bindchange="onIngredientCategoryChange"
        >
          <view class="picker-text">
            {{newIngredient.category === 'main' ? 'ä¸»æ–™' : newIngredient.category === 'side' ? 'è¾…æ–™' : 'è°ƒæ–™'}}
          </view>
        </picker>
      </view>
      <button class="add-btn" bindtap="addIngredient">æ·»åŠ é£Ÿæ</button>
    </view>
  </view>

  <!-- åˆ¶ä½œæ­¥éª¤ -->
  <view class="section">
    <view class="section-header">
      <text class="section-title">åˆ¶ä½œæ­¥éª¤</text>
    </view>

    <view class="steps-list">
      <view class="step-item" wx:for="{{dish.steps}}" wx:key="index">
        <view class="step-number">{{index + 1}}</view>
        <view class="step-content">
          <text class="step-description">{{item.description}}</text>
          <text class="step-tip" wx:if="{{item.tip}}">ğŸ’¡ {{item.tip}}</text>
        </view>
        <text class="remove-btn" bindtap="removeStep" data-index="{{index}}">åˆ é™¤</text>
      </view>
    </view>

    <view class="add-step-form">
      <textarea
        class="form-textarea"
        placeholder="è¯·è¾“å…¥æ­¥éª¤æè¿°"
        value="{{newStep.description}}"
        bindinput="onStepDescriptionInput"
      />
      <input
        class="form-input"
        placeholder="å°è´´å£«ï¼ˆå¯é€‰ï¼‰"
        value="{{newStep.tip}}"
        bindinput="onStepTipInput"
      />
      <button class="add-btn" bindtap="addStep">æ·»åŠ æ­¥éª¤</button>
    </view>
  </view>

  <!-- æ“ä½œæŒ‰é’® -->
  <view class="action-buttons">
    <button class="cancel-btn" bindtap="cancel">å–æ¶ˆ</button>
    <button class="save-btn" bindtap="saveDish">ä¿å­˜èœå“</button>
  </view>
</view>